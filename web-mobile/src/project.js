require=function t(e,n,c){function i(s,a){if(!n[s]){if(!e[s]){var r="function"==typeof require&&require;if(!a&&r)return r(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return i(n?n:t)},l,l.exports,t,e,n,c)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<c.length;s++)i(c[s]);return i}({card:[function(t,e,n){cc._RFpush(e,"1b7869vvN9LbZzHQmJxN2Bi","card"),cc.Class({"extends":cc.Component,properties:{},setInputControl:function(){var t=this;this.touchevent=cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:function(e,n){console.log("cardtouch");var c=e.getLocation();t.moveToPos=t.node.parent.convertToNodeSpaceAR(c);var i=t.moveToPos.x-t.node.position.x,o=t.moveToPos.y-t.node.position.y;return i>=-(t.node.width/2)&&i<=t.node.width/2&&o>=-(t.node.height/2)&&o<=t.node.height/2&&t.turncard(),!0},onTouchMoved:function(t,e){},onTouchEnded:function(t,e){}},t.node)},turncard:function(t){console.log("turn"),cc.eventManager.removeListener(this.touchevent);var e=cc.scaleTo(.1,0,1).easing(cc.easeBackOut()),n=cc.rotateTo(.1,50).easing(cc.easeBackOut()),c=cc.spawn(e,n),i=cc.callFunc(function(){this.node.children[4].getComponent("cc.Sprite").setVisible(this.isturn),this.isturn=!this.isturn},this),o=cc.scaleTo(.1,1,1).easing(cc.easeBackOut()),s=cc.rotateTo(.1,0).easing(cc.easeBackOut()),a=cc.spawn(o,s),r=this.node.parent.getComponent("game"),h=cc.callFunc(function(){t?this.node.emit("turnall"):this.scheduleOnce(function(){this.node.emit("turnall")},1),this.node.fore.off("turnall",this.turncard,this),this.node.fore=void 0,console.log("offturnall")},this),l=cc.callFunc(function(){t?(console.log("turnallfinish"),r.isturnall=!0):console.log("turnfinish")},this),u=cc.sequence(h,c,i,a,l);this.node.runAction(u)},onLoad:function(){this.isturn=!0,this.rand=this.rand||Math.floor(4*Math.random()),this.node.parent.on("dealall",this.setInputControl,this),console.log(this.rand);for(var t=0,e=this.node.children.length-1;e>t;t++)this.node.children[t].getComponent("cc.Sprite").setVisible(!1);this.node.children[this.rand].getComponent("cc.Sprite").setVisible(!0),this.node.children[4].getComponent("cc.Sprite").setVisible(!1)},onturnall:function(){console.log("onturnall"),this.node.fore.on("turnall",this.turncard,this)}}),cc._RFpop()},{}],game:[function(t,e,n){cc._RFpush(e,"ecbfeCSQf5Ma6xEsD85lDKb","game"),cc.Class({"extends":cc.Component,properties:{cardPrefab:{"default":null,type:cc.Prefab}},setInputControl:function(){var t=this;this.touchevent=cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:function(e,n){return console.log(t.isturnall+" "+t.isshuffle),t.isshuffle?(t.isturnall=!1,t.isshuffle=!1,t.onturnall(),t.deal(0)):t.isturnall&&t.shuffle(),!0},onTouchMoved:function(t,e){},onTouchEnded:function(t,e){}},t.node)},onbuttonclick:function(){console.log(this.isturnall+" "+this.isshuffle),this.isturnall&&!this.isshuffle&&(this.shuffle(),this.node.getChildByName("button1").getComponent("cc.Sprite").setVisible(!1))},onLoad:function(){zhqgame=this,this.isturnall=!0,this.isshuffle=!1,this.isdealall=0,this.pointarray=[],this.pointarray[0]=cc.p(-this.node.width/3,this.node.height/3),this.pointarray[1]=cc.p(0,this.node.height/3),this.pointarray[2]=cc.p(this.node.width/3,this.node.height/3),this.pointarray[3]=cc.p(-this.node.width/3,0),this.pointarray[4]=cc.p(this.node.width/3,0),this.pointarray[5]=cc.p(-this.node.width/3,-this.node.height/3),this.pointarray[6]=cc.p(0,-this.node.height/3),this.pointarray[7]=cc.p(this.node.width/3,-this.node.height/3),this.cards=[];for(var t=0;8>t;t++){var e=cc.instantiate(this.cardPrefab);this.node.addChild(e),e.setPosition(this.pointarray[t]),this.cards.push(e)}this.node.on("shuffle",this.dealall,this)},onturnall:function(){this.isturnall=!1;for(var t=0;8>t;t++)7==t?(this.cards[0].fore=this.cards[7],this.cards[0].getComponent("card").onturnall()):(this.cards[t+1].fore=this.cards[t],this.cards[t+1].getComponent("card").onturnall())},deal:function(t){var e,n=cc.moveTo(.2,this.pointarray[t]).easing(cc.easeCubicActionOut());e=t<this.cards.length-1?cc.callFunc(function(){this.deal(t+1)},this):cc.callFunc(function(){console.log("dealall"),this.node.emit("dealall")},this);var c=cc.sequence(n,e);this.cards[t].runAction(c)},dealall:function(){console.log("dealall"),this.isdealall++,this.isdealall>=this.cards.length&&(this.isdealall=!0,this.isturnall=!1,this.isshuffle=!1,this.onturnall(),this.node.getChildByName("button1").getComponent("cc.Sprite").setVisible(!0),this.deal(0))},shuffle:function(){for(var t=0,e=this.cards.length;e>t;t++){var n,c,i=cc.moveTo(.3,cc.p(10*t-35,0)).easing(cc.easeCubicActionOut());4>t?(n=cc.moveTo((2+t)/10,cc.p(-60,0)).easing(cc.easeBackOut()),c=cc.moveTo((8-t)/10,cc.p(10*t-35,0)).easing(cc.easeBackOut())):(n=cc.moveTo((9-t)/10,cc.p(60,0)).easing(cc.easeBackOut()),c=cc.moveTo((t+1)/10,cc.p(10*t-35,0)).easing(cc.easeBackOut()));var o=cc.scaleTo(.2+.05*t,0,1).easing(cc.easeBackOut()),s=cc.rotateTo(.2+.05*t,50).easing(cc.easeBackOut()),a=cc.spawn(o,s),r=cc.callFunc(function(){this.node.children[4].getComponent("cc.Sprite").setVisible(this.isturn),this.isturn=!this.isturn},this.cards[t].getComponent("card")),h=cc.scaleTo(.2+.05*t,1,1).easing(cc.easeBackOut()),l=cc.rotateTo(.2+.05*t,0).easing(cc.easeBackOut()),u=cc.spawn(h,l),d=cc.delayTime(.7-.1*t),f=cc.callFunc(function(){this.node.emit("shuffle")},this),p=cc.sequence(i,n,c,a,r,u,d,n,c,f);this.cards[t].runAction(p)}this.isturnall=!1}}),cc._RFpop()},{}]},{},["card","game"]);
//# sourceMappingURL=project.js.map