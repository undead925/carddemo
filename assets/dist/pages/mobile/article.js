define(function(require){var e=require("jquery"),t=require("layer.m/1.6/layer.m");require("./common");Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(e))e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));for(var i in t)if(new RegExp("("+i+")").test(e))e=e.replace(RegExp.$1,RegExp.$1.length==1?t[i]:("00"+t[i]).substr((""+t[i]).length));return e};var i=e("#type"),l=e("#total_count"),a=e("#total_page"),n=e("#notice_list"),o=e("#header"),c=e("#nid");e(function(){o.find("h1").eq(0).text("详细内容");o.find("a").eq(0).attr("href","/phone/article/article_list/"+c.val()).html('<i class="qtydfont">&#xe623;</i>返回');if(i.val()=="list"){if(c.val()=="media"){o.find("h1").eq(0).text("媒体报道")}else if(c.val()=="notice"||c.val()==""){o.find("h1").eq(0).text("官方公告")}o.find("a").eq(0).attr("href","/more.html").html('<i class="qtydfont">&#xe623;</i>返回');var l=2,s=a.val();e(window).scroll(function(){var i=0;if(document.compatMode==="CSS1Compat"){i=document.documentElement.scrollHeight-(document.documentElement.scrollTop+document.body.scrollTop)-document.documentElement.clientHeight}else{i=document.body.scrollHeight-document.body.scrollTop-document.body.clientHeight}if(i<=100){if(l>s){return false}t.closeAll();t.open({content:"数据加载中",type:2,shadeClose:false});e.ajax({url:"/phone/article/article_list/"+c.val()+"/"+l+"/1/",type:"GET",data:{},dataType:"json",cache:false,async:false,success:function(e){t.closeAll();var i=e.article_list,a="",o="",s="",r=(new Date).Format("yyyy-MM-dd");if(typeof i!="undefined"){var d=i.length;for(var f=0;f<d;f++){if(r==i[f].article_info.addtime){s=" notice-item-new"}else{s=""}o='<a href="/phone/article/article_detail/'+c.val()+"/"+i[f].article_info.id+'" class="notice-item'+s+'">';if(c.val()=="notice"){o+='<h2><i class="qtydfont">&#xe664;</i>'+i[f].article_info.name+"</h2>"}else{if(s!=""){o+='<h2><i class="qtydfont">&#xe664;</i>'+i[f].article_info.name+"</h2>"}else{o+="<h2>"+i[f].article_info.name+"</h2>"}}o+='<p class="note">'+i[f].article_info.abstract+'<em>more</em></p><time class="time">'+i[f].article_info.addtime+"</time></a>";a+=o}n.append(a);l++}},error:function(){t.closeAll()}})}})}})});