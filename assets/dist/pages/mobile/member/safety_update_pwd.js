define(function(require,exports,module){var e=require("jquery"),l=require("layer.m/1.6/layer.m");require("regex");require("../common");var s=e("#old_password"),r=e("#password"),t=e("#repassword"),a=e("#update_pwd_submit"),n="",o="",f="";l.closeAll();l.open({type:2,shadeClose:false,content:"加载中..."});e(function(){e("#header h1").text("登录密码");e("#header a").eq(0).attr("href","/phone/mine/safety").html('<i class="qtydfont">&#xe623;</i>返回');s.blur(function(){var l=e(this).val();if(e.trim(l)==""){n="请输入原密码"}else{n=""}if(n!=""){i(n,1);return false}});r.blur(function(){var l=e(this).val();if(e.trim(l)==""){o="请输入新登录密码"}else if(!(l.length>=6&&l.length<=24)){o="6-24位字符，区分大小写"}else{o=""}if(o!=""){i(o,1);return false}});t.blur(function(){var l=e(this).val();if(l!=r.val()){f="两次密码输入不一致";i(f,1);return false}else{f=""}});a.click(function(){s.trigger("blur");if(n!="")return false;r.trigger("blur");if(o!="")return false;t.trigger("blur");if(f!=""){return false}l.closeAll();l.open({content:"更新中...",type:2,shadeClose:false});e.ajax({url:"",type:"POST",data:{old_password:s.val(),password:r.val(),repassword:t.val()},cache:false,dataType:"json",success:function(e){if(e.code==1e5){l.closeAll();l.open({content:'<div class="tac"><i class="qtydfont c-success ft25">&#xe61b;</i><p class="c-999 mt5">登录密码修改成功，请您重新登录</p></div>',btn:["好"],style:"min-width:300px;",shadeClose:false,yes:function(){window.location.href="/phone/user/login.html";return false}})}else{i(e.msg,3);return false}},error:function(){i("登录密码修改失败",1);return false}})});l.closeAll()});function i(e,s){l.closeAll();l.open({content:e,type:1,style:"padding:10px 15px; background-color:rgba(0,0,0,0.5); color:#fff; border:none;",shadeClose:false,shade:false,time:s})}});