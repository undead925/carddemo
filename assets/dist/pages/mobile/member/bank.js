define(function(require,exports,module){var e=require("jquery"),n=require("layer.m/1.6/layer.m"),a=require("../common");n.closeAll();n.open({type:2,shadeClose:false,content:"加载中..."});module.exports={del_bank:function(a){if(a>0){n.open({content:'<div class="tac"><i class="qtydfont c-warning ft25">&#xe630;</i><p class="c-999 mt5">确定要删除此银行卡么?</p></div>',btn:["确定","取消"],shadeClose:false,style:"min-width:300px;",yes:function(){n.closeAll();n.open({type:2,shadeClose:false,content:"删除中..."});e.ajax({url:"/phone/account/del_bank/"+a,type:"GET",cache:false,data:{},dataType:"json",success:function(e){if(e.code==1e5){n.closeAll();n.open({content:'<div class="tac"><i class="qtydfont c-success ft25">&#xe61b;</i><p class="c-999 mt5">删除成功</p></div>',btn:["好"],style:"min-width:300px;",shadeClose:false,yes:function(){window.location.reload();return false}})}else if(e.code>=110023&&e.code<=110026){n.closeAll();n.open({content:'<div class="tac"><i class="qtydfont c-warning ft25">&#xe630;</i><p class="c-999 mt5">登陆超时，请重新登录</p></div>',btn:["好"],style:"min-width:300px;",shadeClose:false,yes:function(){window.location.href="/phone/user/login.html";return false}})}else if(e.code==930019){window.location.href="/phone/error/sina_error";return false}else{l("删除失败，失败原因：<br>"+e.msg,3);return false}},error:function(){l("抱歉，删除失败",1);return false}})},no:function(){}})}else{l("无此银行卡",1);return false}}};e(function(){e("#header").html('<a href="/phone/account/" class="a-back"><i class="qtydfont">&#xe623;</i>返回</a>'+'<h1 class="primary-title">银行卡列表</h1>'+'<a href="/phone/account/bank_add" class="a-right-link"><i class="qtydfont">&#xe62d;</i></a>');e(".btn-delete").each(function(){e(this).click(function(){module.exports.del_bank(e(this).attr("data"))})});e("#j-bank-add").click(function(){window.location.href="/phone/account/bank_add";return false});e("a[name='open_quick_pay_a']").each(function(){e(this).click(function(){var n=e(this).attr("data");return t(n)})});n.closeAll()});function t(a){var t=e("#bank_update_start_time_"+a),l=e("#bank_update_end_time_"+a),o=e("#bank_update_channel_"+a);if(t.val()!=""&&l.val()!=""&&o.val().indexOf("quick_bind")>-1){var s=new Date(t.val()).getTime(),c=new Date(l.val()).getTime(),i=(new Date).getTime();if(s<=i&&c>=i){n.closeAll();n.open({content:"该行于"+t.val()+"至"+l.val()+"进行系统升级，请稍后再试！",btn:["知道了"],shadeClose:false});return false}}window.location.href="/phone/account/bank_add2/"+a+"?add_type=1";return false}function l(e,a){n.closeAll();n.open({content:e,type:1,style:"padding:10px 15px; background-color:rgba(0,0,0,0.5); color:#fff; border:none;",shadeClose:false,shade:false,time:a})}});